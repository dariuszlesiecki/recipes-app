<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head th:replace="fragments :: html_head(pageTitle='Recipes App - recipe details')" />
<body>
<div th:replace="fragments :: header"></div>
<div class="container" style="text-align: center;">
    <div>
        <div style="background-color: lightgreen; padding: 2% 25% 2% 25%; border: 2px solid darkblue;
             border-radius: 25px; margin-bottom: 2%">

            <div><h2 th:text="${recipe.title}"></h2></div>

            <div class="container">
                <div th:text="'Average rating: '+${ratingService.getAverage(recipe.id)}+'/5.0'"></div>
                <form method="post" th:object="${rating}" th:action="'/rating/'+${recipe.id}+'/add'" class="mt-5">

                    <input id="input-21b" value="4" type="text" class="rating" data-theme="krajee-fas" data-min=0 data-max=5 data-step=0.2 data-size="lg"
                           required title="" th:field="*{score}">

                    <button class="btn btn-primary" type="submit">Add rating</button>
                </form>
            </div>

            <div>Author: <a th:href="@{'/user/' + ${recipe.userId}}" th:text="${recipe.author}"></a></div>
            <div><img class='img-fluid' th:src="'data:image/jpeg;base64,' + ${imgUtil.getImgData(recipe.pic)}" /></div>

        </div>

    </div>

    <div style="background-color: lightgreen; padding: 2% 25% 2% 25%; border: 2px solid darkblue;
             border-radius: 25px;">
        <div><h2>Description</h2></div>
        <div th:text="${recipe.description}"></div>
    </div>


</div>
<div class="container mt-5" style="background-color: powderblue; padding: 5%; border: 2px solid darkblue;
             border-radius: 25px;">
    <h2 style="text-align: center">Post Comment</h2>
    <div class="d-flex justify-content-center row">

        <div class="col-md-8">
            <div class="d-flex flex-column comment-section">
                <div class="bg-light p-2">
                    <form method="post" th:action="@{'/comment/'+ ${recipe.id} +'/add'}" th:object="${comment}">
                        <div class="d-flex flex-row align-items-start">
                            <textarea class="form-control ml-1 shadow-none textarea"id="content" name="content" rows="3" th:value="*{content}" th:errorClass="is-invalid" required></textarea></div>
                        <div class="mt-2 text-right"><button class="btn btn-primary btn-sm shadow-none" type="submit">Post comment</button></div>
                    </form>
                </div>

                <div class="bg-white p-2">
                    <div th:each="comment: ${comments}">
                        <div class="d-flex flex-row user-info">
                            <div class="d-flex flex-column justify-content-start ml-2">
                                <span class="d-block font-weight-bold name" ><a th:href="@{'/user/' + ${comment.userId}}" th:text="${comment.author}"></a></span>
                                <span class="date text-black-50"th:text="${comment.created}"></span>
                            </div>
                        </div>
                        <div class="mt-2">
                            <p class="comment-text" th:text="${comment.content}"></p>
                        </div>
                    </div>
                </div>


            </div>
        </div>
    </div>
</div>

<script>

</script>
</body>
</html>
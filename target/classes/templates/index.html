<!doctype html>
<html lang="en" xmlns:th="https://www.thymeleaf.org">
<head th:replace="fragments :: html_head(pageTitle='Recipes App - Home')"/>
<body>
<div th:replace="fragments :: header"></div>

<div class="container">
    <div class="row pb-4">
        <div class="col-12">
            <input id="term" name="term" placeholder="Search recipe" />
        </div>
    </div>

    <div id="cards" class="row row-cols-1 row-cols-md-3">
        <div th:each="recipe : ${listRecipes}" class="col mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title"><a id="recipe-title" th:href="@{'recipe/' + ${recipe.id}}" th:text="${recipe.title}"></a> </h5>
                </div>
                <a th:href="@{'recipe/' + ${recipe.id}}">
                    <img class="card-img-top " th:src="'data:image/jpeg;base64,' + ${imgUtil.getImgData(recipe.pic)}">
                </a>
            </div>
        </div>
        <div th:each="recipe : ${listRecipesAPI}" class="col mb-4">
            <div class="card">
                <div class="card-body">
                    <h5 class="card-title"><a id="recipeAPI-title" th:href="@{'recipeAPI/' + ${recipe.id}}" th:text="${recipe.title}"></a> </h5>
                </div>
                <a th:href="@{'recipeAPI/' + ${recipe.id}}">
                    <img class="card-img-top " th:src="${recipe.image}">
                </a>
            </div>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {

        $('#term').autocomplete({
            source : '/search',
            minLength : 2,
            select: function( event, ui ) {
                event.preventDefault();
                window.location.href = ui.item.value;
                $('#term').val(ui.item.label);
            }
        });

        $.fn.randomize = function(childElem) {
            return this.each(function() {
                var $this = $(this);
                var elems = $this.children(childElem);
                elems.sort(function() { return (Math.round(Math.random())-0.5); });
                $this.remove(childElem);
                for(var i=0; i < elems.length; i++)
                    $this.append(elems[i]);
            });
        }
        $("#cards").randomize(".col");
    });
</script>
</body>
</html>